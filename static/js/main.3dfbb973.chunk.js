(this["webpackJsonppayment-channel"]=this["webpackJsonppayment-channel"]||[]).push([[0],{17:function(e){e.exports=JSON.parse('{"_format":"hh-sol-artifact-1","contractName":"ReceiverPays","sourceName":"contracts/ReceiverPays.sol","abi":[{"inputs":[],"stateMutability":"payable","type":"constructor"},{"inputs":[],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"payer","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"nonce","type":"uint256"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"claimPayment","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"moreMoney","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"noncesAmount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"noncesRecipients","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address payable","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"recipient","type":"address"}],"name":"recipientBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"shutdown","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"usedNonces","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"}],"bytecode":"0x6080604052600080546001600160a01b031916331790556106b7806100256000396000f3fe6080604052600436106100865760003560e01c80635d2a5617116100595780635d2a5617146102115780636717e41c14610219578063722713f7146102575780638da5cb5b1461026c578063fc0e74d11461028157610086565b80630b822dde1461008b5780631ff6f4b7146100d1578063410b9c051461011657806350036a3a146101e7575b600080fd5b34801561009757600080fd5b506100b5600480360360208110156100ae57600080fd5b5035610296565b604080516001600160a01b039092168252519081900360200190f35b3480156100dd57600080fd5b50610104600480360360208110156100f457600080fd5b50356001600160a01b03166102b1565b60408051918252519081900360200190f35b34801561012257600080fd5b506101e56004803603608081101561013957600080fd5b6001600160a01b03823516916020810135916040820135919081019060808101606082013564010000000081111561017057600080fd5b82018360208201111561018257600080fd5b803590602001918460018302840111640100000000831117156101a457600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295506102cc945050505050565b005b3480156101f357600080fd5b506101046004803603602081101561020a57600080fd5b503561048c565b6101e561049e565b34801561022557600080fd5b506102436004803603602081101561023c57600080fd5b50356104b5565b604080519115158252519081900360200190f35b34801561026357600080fd5b506101046104ca565b34801561027857600080fd5b506100b56104ce565b34801561028d57600080fd5b506101e56104dd565b6002602052600090815260409020546001600160a01b031681565b6001600160a01b031660009081526004602052604090205490565b60008281526001602052604090205460ff1615610330576040805162461bcd60e51b815260206004820152601b60248201527f45737465206368657175652079612073652068612070616761646f0000000000604482015290519081900360640190fd5b6040805133606090811b60208084019190915260348301879052605483018690523090911b6074830152825160688184030181526088909201909252805191012060009061037d90610531565b9050846001600160a01b03166103938284610582565b6001600160a01b0316146103a657600080fd5b6001600160a01b0385166000908152600460205260409020548411156103fd5760405162461bcd60e51b815260040180806020018281038252604c815260200180610636604c913960600191505060405180910390fd5b6000838152600160208181526040808420805460ff19169093179092556001600160a01b0388168352600490528082208054879003905551339186156108fc02918791818181858888f1935050505015801561045d573d6000803e3d6000fd5b505050600090815260026020908152604080832080546001600160a01b03191633179055600390915290205550565b60036020526000908152604090205481565b336000908152600460205260409020805434019055565b60016020526000908152604090205460ff1681565b4790565b6000546001600160a01b031681565b6000546001600160a01b031633146104f457600080fd5b600080546040516001600160a01b03909116914780156108fc02929091818181858888f1935050505015801561052e573d6000803e3d6000fd5b50565b604080517f19457468657265756d205369676e6564204d6573736167653a0a333200000000602080830191909152603c8083019490945282518083039094018452605c909101909152815191012090565b60008060008061059185610606565b92509250925060018684848460405160008152602001604052604051808581526020018460ff1681526020018381526020018281526020019450505050506020604051602081039080840390855afa1580156105f1573d6000803e3d6000fd5b5050604051601f190151979650505050505050565b6000806000835160411461061957600080fd5b5050506020810151604082015160609092015160001a9290919056fe456c2070616761646f72206e6f20646973706f6e652064656c2064696e65726f20737566696369656e746520706172612070616761726c652e205265636c616d6520737520696e677265736fa2646970667358221220d7e7d3ea52a270be58d7cb79064948ac2bbe1d7a0dd0e21161d972a1a7461e4964736f6c63430007060033","deployedBytecode":"0x6080604052600436106100865760003560e01c80635d2a5617116100595780635d2a5617146102115780636717e41c14610219578063722713f7146102575780638da5cb5b1461026c578063fc0e74d11461028157610086565b80630b822dde1461008b5780631ff6f4b7146100d1578063410b9c051461011657806350036a3a146101e7575b600080fd5b34801561009757600080fd5b506100b5600480360360208110156100ae57600080fd5b5035610296565b604080516001600160a01b039092168252519081900360200190f35b3480156100dd57600080fd5b50610104600480360360208110156100f457600080fd5b50356001600160a01b03166102b1565b60408051918252519081900360200190f35b34801561012257600080fd5b506101e56004803603608081101561013957600080fd5b6001600160a01b03823516916020810135916040820135919081019060808101606082013564010000000081111561017057600080fd5b82018360208201111561018257600080fd5b803590602001918460018302840111640100000000831117156101a457600080fd5b91908080601f0160208091040260200160405190810160405280939291908181526020018383808284376000920191909152509295506102cc945050505050565b005b3480156101f357600080fd5b506101046004803603602081101561020a57600080fd5b503561048c565b6101e561049e565b34801561022557600080fd5b506102436004803603602081101561023c57600080fd5b50356104b5565b604080519115158252519081900360200190f35b34801561026357600080fd5b506101046104ca565b34801561027857600080fd5b506100b56104ce565b34801561028d57600080fd5b506101e56104dd565b6002602052600090815260409020546001600160a01b031681565b6001600160a01b031660009081526004602052604090205490565b60008281526001602052604090205460ff1615610330576040805162461bcd60e51b815260206004820152601b60248201527f45737465206368657175652079612073652068612070616761646f0000000000604482015290519081900360640190fd5b6040805133606090811b60208084019190915260348301879052605483018690523090911b6074830152825160688184030181526088909201909252805191012060009061037d90610531565b9050846001600160a01b03166103938284610582565b6001600160a01b0316146103a657600080fd5b6001600160a01b0385166000908152600460205260409020548411156103fd5760405162461bcd60e51b815260040180806020018281038252604c815260200180610636604c913960600191505060405180910390fd5b6000838152600160208181526040808420805460ff19169093179092556001600160a01b0388168352600490528082208054879003905551339186156108fc02918791818181858888f1935050505015801561045d573d6000803e3d6000fd5b505050600090815260026020908152604080832080546001600160a01b03191633179055600390915290205550565b60036020526000908152604090205481565b336000908152600460205260409020805434019055565b60016020526000908152604090205460ff1681565b4790565b6000546001600160a01b031681565b6000546001600160a01b031633146104f457600080fd5b600080546040516001600160a01b03909116914780156108fc02929091818181858888f1935050505015801561052e573d6000803e3d6000fd5b50565b604080517f19457468657265756d205369676e6564204d6573736167653a0a333200000000602080830191909152603c8083019490945282518083039094018452605c909101909152815191012090565b60008060008061059185610606565b92509250925060018684848460405160008152602001604052604051808581526020018460ff1681526020018381526020018281526020019450505050506020604051602081039080840390855afa1580156105f1573d6000803e3d6000fd5b5050604051601f190151979650505050505050565b6000806000835160411461061957600080fd5b5050506020810151604082015160609092015160001a9290919056fe456c2070616761646f72206e6f20646973706f6e652064656c2064696e65726f20737566696369656e746520706172612070616761726c652e205265636c616d6520737520696e677265736fa2646970667358221220d7e7d3ea52a270be58d7cb79064948ac2bbe1d7a0dd0e21161d972a1a7461e4964736f6c63430007060033","linkReferences":{},"deployedLinkReferences":{}}')},28:function(e){e.exports=JSON.parse('{"_format":"hh-sol-artifact-1","contractName":"Signature","sourceName":"contracts/Signature.sol","abi":[{"inputs":[{"internalType":"bytes32","name":"_messageHash","type":"bytes32"}],"name":"getEthSignedMessageHash","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"address","name":"_to","type":"address"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"uint256","name":"_nonce","type":"uint256"},{"internalType":"address","name":"_contract","type":"address"}],"name":"getMessageHash","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"bytes32","name":"_ethSignedMessageHash","type":"bytes32"},{"internalType":"bytes","name":"_signature","type":"bytes"}],"name":"recoverSigner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"bytes","name":"sig","type":"bytes"}],"name":"splitSignature","outputs":[{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"},{"internalType":"uint8","name":"v","type":"uint8"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"address","name":"_signer","type":"address"},{"internalType":"address","name":"_to","type":"address"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"uint256","name":"_nonce","type":"uint256"},{"internalType":"address","name":"_contract","type":"address"},{"internalType":"bytes","name":"signature","type":"bytes"}],"name":"verify","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"pure","type":"function"}],"bytecode":"0x608060405234801561001057600080fd5b50610561806100206000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c80636aa404521461005c57806397aba7f914610143578063a7bb58031461020c578063bfa4bf9a146102d3578063fa5408011461031f575b600080fd5b61012f600480360360c081101561007257600080fd5b6001600160a01b038235811692602081013582169260408201359260608301359260808101359091169181019060c0810160a08201356401000000008111156100ba57600080fd5b8201836020820111156100cc57600080fd5b803590602001918460018302840111640100000000831117156100ee57600080fd5b91908080601f01602080910402602001604051908101604052809392919081815260200183838082843760009201919091525092955061033c945050505050565b604080519115158252519081900360200190f35b6101f06004803603604081101561015957600080fd5b8135919081019060408101602082013564010000000081111561017b57600080fd5b82018360208201111561018d57600080fd5b803590602001918460018302840111640100000000831117156101af57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929550610385945050505050565b604080516001600160a01b039092168252519081900360200190f35b6102b26004803603602081101561022257600080fd5b81019060208101813564010000000081111561023d57600080fd5b82018360208201111561024f57600080fd5b8035906020019184600183028401116401000000008311171561027157600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929550610409945050505050565b60408051938452602084019290925260ff1682820152519081900360600190f35b61030d600480360360808110156102e957600080fd5b506001600160a01b0381358116916020810135916040820135916060013516610482565b60408051918252519081900360200190f35b61030d6004803603602081101561033557600080fd5b50356104da565b60008061034b87878787610482565b90506000610358826104da565b9050886001600160a01b031661036e8286610385565b6001600160a01b0316149998505050505050505050565b60008060008061039485610409565b92509250925060018682858560405160008152602001604052604051808581526020018460ff1681526020018381526020018281526020019450505050506020604051602081039080840390855afa1580156103f4573d6000803e3d6000fd5b5050604051601f190151979650505050505050565b60008060008351604114610464576040805162461bcd60e51b815260206004820152601860248201527f696e76616c6964207369676e6174757265206c656e6774680000000000000000604482015290519081900360640190fd5b50505060208101516040820151606090920151909260009190911a90565b604080516bffffffffffffffffffffffff19606096871b8116602080840191909152603483019690965260548201949094529190941b9091166074820152825160688183030181526088909101909252815191012090565b604080517f19457468657265756d205369676e6564204d6573736167653a0a333200000000602080830191909152603c8083019490945282518083039094018452605c90910190915281519101209056fea2646970667358221220d69f3c15de97541d89dc6b780dcb0c31e3b3418964b70818c67f6655c03263ac64736f6c63430007060033","deployedBytecode":"0x608060405234801561001057600080fd5b50600436106100575760003560e01c80636aa404521461005c57806397aba7f914610143578063a7bb58031461020c578063bfa4bf9a146102d3578063fa5408011461031f575b600080fd5b61012f600480360360c081101561007257600080fd5b6001600160a01b038235811692602081013582169260408201359260608301359260808101359091169181019060c0810160a08201356401000000008111156100ba57600080fd5b8201836020820111156100cc57600080fd5b803590602001918460018302840111640100000000831117156100ee57600080fd5b91908080601f01602080910402602001604051908101604052809392919081815260200183838082843760009201919091525092955061033c945050505050565b604080519115158252519081900360200190f35b6101f06004803603604081101561015957600080fd5b8135919081019060408101602082013564010000000081111561017b57600080fd5b82018360208201111561018d57600080fd5b803590602001918460018302840111640100000000831117156101af57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929550610385945050505050565b604080516001600160a01b039092168252519081900360200190f35b6102b26004803603602081101561022257600080fd5b81019060208101813564010000000081111561023d57600080fd5b82018360208201111561024f57600080fd5b8035906020019184600183028401116401000000008311171561027157600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929550610409945050505050565b60408051938452602084019290925260ff1682820152519081900360600190f35b61030d600480360360808110156102e957600080fd5b506001600160a01b0381358116916020810135916040820135916060013516610482565b60408051918252519081900360200190f35b61030d6004803603602081101561033557600080fd5b50356104da565b60008061034b87878787610482565b90506000610358826104da565b9050886001600160a01b031661036e8286610385565b6001600160a01b0316149998505050505050505050565b60008060008061039485610409565b92509250925060018682858560405160008152602001604052604051808581526020018460ff1681526020018381526020018281526020019450505050506020604051602081039080840390855afa1580156103f4573d6000803e3d6000fd5b5050604051601f190151979650505050505050565b60008060008351604114610464576040805162461bcd60e51b815260206004820152601860248201527f696e76616c6964207369676e6174757265206c656e6774680000000000000000604482015290519081900360640190fd5b50505060208101516040820151606090920151909260009190911a90565b604080516bffffffffffffffffffffffff19606096871b8116602080840191909152603483019690965260548201949094529190941b9091166074820152825160688183030181526088909101909252815191012090565b604080517f19457468657265756d205369676e6564204d6573736167653a0a333200000000602080830191909152603c8083019490945282518083039094018452605c90910190915281519101209056fea2646970667358221220d69f3c15de97541d89dc6b780dcb0c31e3b3418964b70818c67f6655c03263ac64736f6c63430007060033","linkReferences":{},"deployedLinkReferences":{}}')},39:function(e,a,t){},40:function(e,a,t){},43:function(e,a){},54:function(e,a,t){"use strict";t.r(a);var n=t(4),s=t.n(n),c=t(27),r=t.n(c),o=(t(39),t(40),t(6)),i=t.n(o),d=t(28),l=t(2);var b=()=>{async function e(){if("undefined"!==typeof window.ethereum){let e=(await window.ethereum.request({method:"eth_requestAccounts"}))[0],a=e.substr(0,4),t=e.substr(-4,4);document.querySelector("#intro").innerHTML="conectado con la cuenta: "+a+"..."+t}else i.a.fire({title:"No tiene metamask instalado",text:"Cambie de navegador o puede instal\xe1rselo apretando al bot\xf3n",showCancelButton:!0,confirmButtonText:"Instalar",imageUrl:"./img/metamask-transparent.png",imageAlt:"Instalar metamask"}).then((e=>{e.isConfirmed&&window.open("https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn","_blank",'rel="noreferrer"')}))}return Object(n.useEffect)((function(){!async function(){"undefined"!==typeof window.ethereum&&window.ethereum.on("accountsChanged",(async function(){await e()}))}()}),[]),Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)("div",{className:"b-example-divider"}),Object(l.jsx)("div",{className:"bg-dark container col-xl-10 col-xxl-8 px-4 py-5",children:Object(l.jsx)("div",{className:"row align-items-center g-lg-5 py-5",children:Object(l.jsx)("h1",{className:"display-4 fw-bold lh-1 mb-3 text-white",children:"Canal de pago para red Ethereum o similares"})})}),Object(l.jsx)("div",{className:"bg-dark container col-xl-10 col-xxl-8 px-4 py-5",children:Object(l.jsxs)("div",{className:"row align-items-center g-lg-5 py-5",children:[Object(l.jsxs)("div",{className:"col-lg-7 text-center text-lg-start",children:[Object(l.jsx)("h1",{className:"display-4 fw-bold lh-1 mb-3 text-white",children:"\xbfQu\xe9 es un canal de pago?"}),Object(l.jsxs)("p",{className:"col-lg-10 fs-4 text-white",children:["Un canal de pago, en ingl\xe9s: ",Object(l.jsx)("i",{children:"Payment Channel"}),", es una v\xeda para realizar numerosas transacciones de una criptomoneda con el m\xednimo coste. "]}),Object(l.jsxs)("p",{className:"col-lg-10 fs-4 text-white",children:["La gran mayor\xeda de las criptomonedas de segunda generaci\xf3n disponen de una gran limitaci\xf3n a la hora de realizar numerosas transacciones. No solo en tanto a la escalabilidad por segundo que pueda disponer la blockchain, sino por ",Object(l.jsx)("strong",{children:"las altas comisiones existentes"})," por cada transacci\xf3n. Especialmente dolorosas son en la red Ethereum, que, a Septiembre del 2021, siguen siendo inasumibles para el envio de micropagos o para realizar un canal constante de los mismos, como por ejemplo, el env\xedo mensual de n\xf3minas a un n\xfamero indeterminado de trabajadores."]}),Object(l.jsxs)("p",{className:"col-lg-10 fs-4 text-white",children:["Con un canal de pago se pueden realizar  tantas transacciones como se desee en ",Object(l.jsx)("strong",{children:"segundo plano"}),", reduciendo as\xed las transacciones reales en la  blockchain principal ",Object(l.jsx)("strong",{children:"a \xfanicamente dos"}),". Volviendo al ejemplo de pago de una n\xf3mina, el pagador puede ingresar un dinero total y realizar ",Object(l.jsx)("strong",{children:"tantos cheques a cobrar como empleados disponga"}),". Una \xfanica transacci\xf3n para ingresar, y una \xfanica transacci\xf3n por empleado a cobrar."]}),Object(l.jsxs)("p",{className:"col-lg-10 fs-4 text-white",children:[" ",Object(l.jsx)("strong",{children:"Atenci\xf3n, "}),"Nuevo contrato deployado. Si usted meti\xf3 dinero en el anterior contrato no lo podr\xe1 utilizar. Por suerte son tokens de testnet."]})]}),Object(l.jsxs)("div",{className:"col-md-10 mx-auto col-lg-5",children:[Object(l.jsx)("img",{src:"./img/dibujo.png",width:"300",alt:"dibujo de canal de pago"}),Object(l.jsx)("div",{})]})]})}),Object(l.jsx)("div",{className:"bg-dark container col-xl-10 col-xxl-8 px-4 py-5",children:Object(l.jsxs)("div",{className:"row align-items-center g-lg-5 py-5",children:[Object(l.jsxs)("div",{className:"col-lg-7 text-center text-lg-start",children:[Object(l.jsx)("h2",{className:"display-4 fw-bold lh-1 mb-3 text-white",children:"Usaremos la red Binance Smart Chain"}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"Lo primero, deme su permiso para conectarme a su Metamask. La conexi\xf3n autom\xe1tica de su metamask por parte de una DAPP es una mala pr\xe1ctica. T\xe9ngalo en cuenta a la hora de crear la suya. "}),Object(l.jsxs)("p",{className:"col-lg-10 fs-4 text-white",children:[" Si usted ",Object(l.jsx)("strong",{children:"no dispone"})," de la red de pruebas de BSC, se instalar\xe1 apretando ",Object(l.jsx)("strong",{children:"el bot\xf3n naranja"}),". Si ya la dispone, cambiar\xe1 a esa red autom\xe1ticamente."]}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"Si no ten\xeda la Red, tampoco tendra BNBs de prueba para hacer el tutorial. Apretando al boton azul usted podr\xe1 reclamar un BNB para poder crear un cheque."})]}),Object(l.jsxs)("div",{className:"col-md-10 mx-auto col-lg-5",children:[Object(l.jsx)("button",{id:"btn-firma",onClick:()=>e(),className:"w-100 btn btn-lg btn-danger mb-4",type:"button",children:"Conectar Metamask"}),Object(l.jsx)("button",{id:"bnbNetwork",onClick:()=>async function(){return window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:"0x61",chainName:"BSCTESTNET",rpcUrls:["https://data-seed-prebsc-2-s3.binance.org:8545"],nativeCurrency:{name:"BINANCE COIN",symbol:"BNB",decimals:18},blockExplorerUrls:["https://testnet.bscscan.com/"]}]})}(),className:"w-100 btn btn-lg btn-warning mb-4",type:"button",children:"A\xf1adir Red Binance Smart Chain de pruebas"}),Object(l.jsx)("button",{id:"faucet",onClick:()=>{window.open("https://testnet.binance.org/faucet-smart","_blank",'rel="noreferrer"')},className:"w-100 btn btn-lg btn-primary",type:"button",children:"Faucet de Binance"}),Object(l.jsx)("hr",{className:"my-4"}),Object(l.jsxs)("form",{className:"p-4 p-md-5 border rounded-3 bg-light",children:[Object(l.jsx)("div",{className:"form-floating mb-3"}),Object(l.jsx)("hr",{className:"my-4"}),Object(l.jsx)("small",{id:"intro",className:"text-muted",children:"No conectado"})]}),Object(l.jsx)("div",{})]})]})})]})},m=t(7),u=t(17);var f=()=>{const[e,a]=Object(n.useState)("0.1"),[t,s]=Object(n.useState)(""),c="0x65D56f700BF136b32162Ea82dAa55516d688B1c6",[r,o]=Object(n.useState)("no-net"),d="bnbt",[b,f]=Object(n.useState)(0);async function p(){console.log("dentro de takeNetwork");const e=new m.a.providers.Web3Provider(window.ethereum),a=await e.getNetwork();console.log("network",a.name),o(a.name)}async function h(){if("undefined"!==typeof window.ethereum)if(r==d||1==b){const[t]=await window.ethereum.request({method:"eth_requestAccounts"}),n=new m.a.providers.Web3Provider(window.ethereum).getSigner(),s=new m.a.Contract(c,u.abi,n);let r=m.a.utils.parseEther(e).toString();try{const a=await s.moreMoney({value:r});i.a.fire({title:"Procesando el ingreso",text:"Espere, y no actualice la p\xe1gina",showConfirmButton:!1,imageUrl:"./img/processing.gif",imageWidth:100,imageHeight:100,imageAlt:"Procesando el ingreso"});await a.wait()&&i.a.fire({title:"Se ha enviado ".concat(e," BNB al contrato ").concat(c),html:'<a href="https://testnet.bscscan.com/tx/'.concat(a.hash,'" target="_blank" rel="noreferrer">Hash de la transacci\xf3n</a>'),icon:"success",confirmButtonText:"Cerrar"}),j()}catch(a){let e=a.message;i.a.fire({title:"Ooops!",text:"".concat(e),icon:"error",confirmButtonText:"Cerrar"}),console.log("Error: ",a)}}else f(1),async function(){console.log("en isInNetwork"),"no-net"!==r||r===d?i.a.fire({title:"red",text:"Est\xe1s en la red "+r+", has de cambiar a la red "+d,confirmButtonText:"Cambiar o instalar red BNB de pruebas",imageUrl:"./img/processing.gif",imageWidth:300,imageAlt:"Red Binance Smart Chain"}).then((e=>{e.isConfirmed&&async function(){let e=[{chainId:"0x61",chainName:"BSCTESTNET",rpcUrls:["https://data-seed-prebsc-2-s3.binance.org:8545"],nativeCurrency:{name:"BINANCE COIN",symbol:"BNB",decimals:18},blockExplorerUrls:["https://testnet.bscscan.com/"]}];window.ethereum.request({method:"wallet_addEthereumChain",params:e}).then(p())}()})):h()}()}async function j(){const[e]=await window.ethereum.request({method:"eth_requestAccounts"}),a=new m.a.providers.Web3Provider(window.ethereum).getSigner(),t=new m.a.Contract(c,u.abi,a);try{const a=await t.recipientBalance(e);let n=m.a.utils.formatEther(a).toString(),c=Number.parseFloat(n).toFixed(2);s("Dispone de ".concat(c," BNB ingresados"))}catch(n){let e=n.message;i.a.fire({title:"Ooops!",text:"".concat(e),icon:"error",confirmButtonText:"Cerrar"}),console.log("Error: ",n)}}return Object(n.useEffect)((function(){p(),async function(){"undefined"!==typeof window.ethereum&&window.ethereum.on("accountsChanged",(async function(){await j()}))}()}),[r]),Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)("div",{className:"b-example-divider"}),Object(l.jsx)("div",{className:"bg-dark container col-xl-10 col-xxl-8 px-4 py-5",children:Object(l.jsxs)("div",{className:"row align-items-center g-lg-5 py-5",children:[Object(l.jsxs)("div",{className:"col-lg-7 text-center text-lg-start",children:[Object(l.jsx)("h2",{className:"display-4 fw-bold lh-1 mb-3 text-white",children:"Ingresar BNB al contrato"}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"El contrato est\xe1 preparado para recibir BNBs de cualquier cuenta."}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"Se controla que nadie pueda gastar m\xe1s de lo que ingrese. Por defecto la cantidad es 0.1 BNB pero puede colocar la cantidad que desee."}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"Si no ve su saldo ingresado en el contrato apriete el bot\xf3n verde."}),Object(l.jsxs)("p",{className:"col-lg-10 fs-4 text-white",children:["Si usted realiza un cheque de 1 BNB y tiene en el contrato solo 0.5 ingresados ",Object(l.jsx)("strong",{children:"el cheque no se cobrar\xe1 ni se anular\xe1"}),". Puede ingresar posteriormente los 0.5 BNB faltantes para que el cobrador pueda ejecutar su cheque. "]})]}),Object(l.jsxs)("div",{className:"col-md-10 mx-auto col-lg-5",children:[Object(l.jsxs)("form",{className:"p-4 p-md-5 border rounded-3 bg-light",children:[Object(l.jsxs)("div",{className:"form-floating mb-3",children:[Object(l.jsx)("input",{value:e,onChange:e=>a(e.target.value.replace(",",".")),type:"text",className:"form-control",id:"amountToSend"}),Object(l.jsx)("label",{htmlFor:"amountToSend",children:"BNBs a ingresar"})]}),Object(l.jsx)("button",{id:"btn-deposit",onClick:()=>h(),className:"w-100 btn btn-lg btn-primary",type:"button",children:"Ingresar"}),Object(l.jsx)("hr",{className:"my-4"}),Object(l.jsx)("button",{id:"btn-balance",onClick:()=>j(),className:"btn-success w-100 btn btn-lg",type:"button",children:"Comprobar su balance"}),Object(l.jsx)("hr",{className:"my-4"}),Object(l.jsx)("small",{id:"balance",className:"text-muted",children:t})]}),Object(l.jsx)("div",{})]})]})})]})};var p=()=>{const[e,a]=Object(n.useState)("0.1"),[t,s]=Object(n.useState)(0),[c,r]=Object(n.useState)(""),[o,d]=Object(n.useState)("");return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)("div",{className:"b-example-divider"}),Object(l.jsx)("div",{className:"bg-dark container col-xl-10 col-xxl-8 px-4 py-5",children:Object(l.jsxs)("div",{className:"row align-items-center g-lg-5 py-5",children:[Object(l.jsxs)("div",{className:"col-lg-7 text-center text-lg-start",children:[Object(l.jsx)("h2",{className:"display-4 fw-bold lh-1 mb-3 text-white",children:"Cobrar Cheque"}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"Introduzca los datos requeridos para hacer efectivo su cheque. Recuerde estar usando la cuenta acreedora del cheque en su Metamask para poder cobrarlo. Cuidado al copiar con los espacios."})]}),Object(l.jsxs)("div",{className:"col-md-10 mx-auto col-lg-5",children:[Object(l.jsxs)("form",{className:"p-4 p-md-5 border rounded-3 bg-light",children:[Object(l.jsxs)("div",{className:"form-floating mb-3",children:[Object(l.jsx)("input",{value:t,onChange:e=>s(e.target.value),type:"number",className:"form-control",id:"serie2"}),Object(l.jsx)("label",{htmlFor:"serie2",children:"Serie del cheque"})]}),Object(l.jsxs)("div",{className:"form-floating mb-3",children:[Object(l.jsx)("input",{value:e,onChange:e=>a(e.target.value.replace(",",".")),type:"text",className:"form-control",id:"amountToPay2"}),Object(l.jsx)("label",{htmlFor:"amountToPay2",children:"BNBs a cobrar"})]}),Object(l.jsxs)("div",{className:"form-floating mb-3",children:[Object(l.jsx)("input",{value:o,onChange:e=>d(e.target.value),type:"text",className:"form-control",id:"signedHash"}),Object(l.jsx)("label",{htmlFor:"signedHash",children:"Hash firmado"})]}),Object(l.jsxs)("div",{className:"form-floating mb-3 d-inline-flex",children:[Object(l.jsx)("input",{value:c,onChange:e=>r(e.target.value),type:"text",className:"form-control",id:"payer"}),Object(l.jsx)("label",{htmlFor:"payer",children:"Pagador"}),Object(l.jsx)("button",{type:"button",className:"btn btn-secondary mx-3","data-bs-toggle":"modal","data-bs-target":"#pagadorModal",children:Object(l.jsx)("i",{className:"fa fa-info"})})]}),Object(l.jsx)("button",{id:"btn-receive",onClick:()=>async function(){if("undefined"!==typeof window.ethereum){const[n]=await window.ethereum.request({method:"eth_requestAccounts"}),s=new m.a.providers.Web3Provider(window.ethereum).getSigner(),r=new m.a.Contract("0x65D56f700BF136b32162Ea82dAa55516d688B1c6",u.abi,s);let d=m.a.utils.parseEther(e).toString();try{const a=await r.claimPayment(c,d,t,o,{from:n});i.a.fire({title:"Procesando el pago del cheque",text:"Espere. No actualice la p\xe1gina",showConfirmButton:!1,imageUrl:"./img/processing.gif",imageWidth:100,imageHeight:100,imageAlt:"Procesando el ingreso"}),await a.wait(),a&&i.a.fire({title:"Se ha env\xedado ".concat(e," BNB a la cuenta ").concat(n),html:'<a href="https://testnet.bscscan.com/tx/'.concat(a.hash,'" target="_blank" rel="noreferrer">Hash de la transacci\xf3n</a>'),icon:"success",confirmButtonText:"Cerrar"}),console.log("transaction ",a)}catch(a){let e=a.message;a.data&&("execution reverted: Este cheque ya se ha pagado"===a.data.message?e="Este cheque ya se ha pagado":"execution reverted: El pagador no dispone del dinero suficiente para pagarle. Reclame su ingreso"===a.data.message?e="El pagador no dispone del dinero suficiente para pagarle. Reclame su ingreso":console.log("error: ",e)),i.a.fire({title:"Ooops!",text:"".concat(e),icon:"error",confirmButtonText:"Cerrar"}),console.log("Error: ",a)}}}(),className:"w-100 btn btn-lg btn-primary",type:"button",children:"Cobrar"}),Object(l.jsx)("hr",{className:"my-4"})]}),Object(l.jsx)("div",{})]})]})}),Object(l.jsx)("div",{className:"modal fade",id:"pagadorModal","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"pagadorModalLabel","aria-hidden":"true",children:Object(l.jsx)("div",{className:"modal-dialog",children:Object(l.jsxs)("div",{className:"modal-content",children:[Object(l.jsxs)("div",{className:"modal-header",children:[Object(l.jsx)("h5",{className:"modal-title",id:"pagadorModalLabel",children:"Registro del pagador"}),Object(l.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(l.jsxs)("div",{className:"modal-body",children:["Ya que \xe9sta DAPP tiene una intenci\xf3n divulgativa, el contrato de pago tiene que estar disponible para diversos pagadores. Para poder realizar esa funci\xf3n es necesario que a la hora del cobro el acreedor determine quien es el que le debe el dinero. \xc9ste usuario adem\xe1s habr\xe1 tenido que ingresar la cantidad prometida porque la seguridad del contrato ",Object(l.jsx)("strong",{children:"rechazar\xe1 todo pago de un pagador que no haya ingresado el dinero demandado"}),". ",Object(l.jsx)("br",{}),Object(l.jsx)("br",{}),"Los cheques que no se hayan podido cobrar por falta de fondos ",Object(l.jsx)("strong",{children:"no se anulan"}),". Es decir, si el pagador ingresa el dinero posteriormente a la reclamaci\xf3n del acreedor se podr\xe1 ejecutar el cobro sin problemas.  ",Object(l.jsx)("br",{}),Object(l.jsx)("br",{}),"Para eliminar la desconfianza entre las partes, propio de la naturaleza de todo contrato inteligente, se podr\xeda a\xf1adir una cla\xfasula m\xe1s para que no pudiese realizar cheques quien no disponga del dinero ingresado en el contrato pagador de antemano. Pero he considerado que ya he complicado bastante los contratos para quien desee estudiarlos, y por tanto, he decidido no implementar \xe9sta importante cla\xfasula para no complicar m\xe1s los contratos de la DAAP."]}),Object(l.jsx)("div",{className:"modal-footer",children:Object(l.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})})]})},h=t(32),j=t.n(h);var x=function(){const[e,a]=Object(n.useState)(""),[t,s]=Object(n.useState)(Math.floor((new Date).getTime()/1e3)),[c,r]=Object(n.useState)("0.1"),[o,u]=Object(n.useState)(""),[h,x]=Object(n.useState)("0x65D56f700BF136b32162Ea82dAa55516d688B1c6"),[g,y]=Object(n.useState)(""),[O,N]=j()(),[v,w]=Object(n.useState)(!0);return Object(l.jsxs)("div",{className:"App",children:[Object(l.jsx)(b,{}),Object(l.jsx)(f,{}),Object(l.jsx)("div",{className:"bg-dark container col-xl-10 col-xxl-8 px-4 py-5",children:Object(l.jsxs)("div",{className:"row justify-content-md-center",children:[Object(l.jsx)("h3",{className:"text-white text-center col-lg-4",children:"\xbfQu\xe9 desea hacer?"}),Object(l.jsx)("button",{className:"btn btn-lg btn-primary col-lg-4",onClick:()=>w(!v),children:" Crear Cheque / Cobrar Cheque "})]})}),Object(l.jsxs)("div",{className:v?"":"d-none",children:[Object(l.jsx)("div",{className:"b-example-divider"}),Object(l.jsx)("div",{className:"bg-dark container col-xl-10 col-xxl-8 px-4 py-5",children:Object(l.jsxs)("div",{className:"row align-items-center g-lg-5 py-5",children:[Object(l.jsxs)("div",{className:"col-lg-7 text-center text-lg-start",children:[Object(l.jsx)("h2",{className:"display-4 fw-bold lh-1 mb-3 text-white",children:"Crear Cheque"}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"Introduzca los datos del beneficiario y cantidad a abonar para que puedan ser firmados con la cuenta que tenga conectada."}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"Despu\xe9s de que usted firme el Hash recibir\xe1 otro con su firma inclu\xedda. Junto a el le aparecer\xe1n los datos que tendr\xeda que mandar al cobrador del mismo. Tenga a mano el bloc de notas para copiarlos."}),Object(l.jsx)("p",{className:"col-lg-10 fs-4 text-white",children:"A\xf1ada otra cuenta de su billetera como cobrador si usted quiere realizar tambi\xe9n el cobro del cheque."}),Object(l.jsxs)("p",{className:"col-lg-10 fs-4 text-white",children:["El hash se puede firmar fuera de la red como ver\xe1 en otros tutoriales. Sin embargo, yo utilizo otro contrato en la testnet. Si tambi\xe9n desea verlo ",Object(l.jsx)("a",{href:"https://testnet.bscscan.com/address/0x854F2CBa80dAe7989Dd5729Ed2a71A1923d43243#code ",target:"_blank",rel:"noreferrer",children:"aqu\xed"})," lo tiene. "]})]}),Object(l.jsxs)("div",{className:"col-md-10 mx-auto col-lg-5",children:[Object(l.jsxs)("form",{className:"p-4 p-md-5 border rounded-3 bg-light",children:[Object(l.jsxs)("div",{className:"form-floating mb-3 d-inline-flex",children:[Object(l.jsx)("input",{value:h,onChange:e=>x(e.target.value),type:"text",className:"form-control",id:"contractAddress",disabled:!0}),Object(l.jsx)("button",{type:"button",className:"btn btn-secondary mx-3","data-bs-toggle":"modal","data-bs-target":"#contratoModal",children:Object(l.jsx)("i",{className:"fa fa-info"})}),Object(l.jsx)("label",{htmlFor:"contractAddress",children:"Contrato de cobro"})]}),Object(l.jsxs)("div",{className:"form-floating mb-3",children:[Object(l.jsx)("input",{value:e,onChange:e=>a(e.target.value),type:"text",className:"form-control",id:"recipient"}),Object(l.jsx)("label",{htmlFor:"recipient",children:"Beneficiario"})]}),Object(l.jsxs)("div",{className:"form-floating mb-3 d-inline-flex",children:[Object(l.jsx)("input",{value:t,onChange:e=>s(e.target.value),type:"number",className:"form-control",id:"serie"}),Object(l.jsx)("label",{htmlFor:"serie",children:"Serie del cheque"}),Object(l.jsx)("button",{type:"button",className:"btn btn-secondary mx-3","data-bs-toggle":"modal","data-bs-target":"#serieModal",children:Object(l.jsx)("i",{className:"fa fa-info"})})]}),Object(l.jsxs)("div",{className:"form-floating mb-3",children:[Object(l.jsx)("input",{value:c,onChange:e=>r(e.target.value.replace(",",".")),type:"text",className:"form-control",id:"amountToPay"}),Object(l.jsx)("label",{htmlFor:"amountToPay",children:"BNBs a cobrar"})]}),Object(l.jsx)("button",{id:"btn-firma",onClick:()=>async function(){if("undefined"!==typeof window.ethereum){const[n]=await window.ethereum.request({method:"eth_requestAccounts"}),s=new m.a.providers.Web3Provider(window.ethereum).getSigner(),r=new m.a.Contract("0x854F2CBa80dAe7989Dd5729Ed2a71A1923d43243",d.abi,s);let o=m.a.utils.parseEther(c).toString();try{const a=await r.getMessageHash(e,o,t,h);let s=await window.ethereum.request({method:"personal_sign",params:[n,a]});i.a.fire({title:"Copie los datos para enviar al cobrador",text:"Numero de serie: ".concat(t," Importe: ").concat(c," Pagador: ").concat(n," Hash firmado: ").concat(s),showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Copiar al portapapeles",denyButtonText:"Solo quer\xeda ver como era"}).then((e=>{e.isConfirmed?(N("Numero de serie: ".concat(t," Importe: ").concat(c," Pagador: ").concat(n," Hash firmado: ").concat(s)),i.a.fire("Datos Copiados a su portapapeles","","success")):e.isDenied&&i.a.fire("El formulario conserva los datos si a\xfan desea recuperarlos. En la consola de Javascript podr\xe1 encontrar el hash firmado.","","info")})),console.log("hash firmado: ",s),y(s),u(n)}catch(a){let e=a.message;i.a.fire({title:"Ooops!",text:"".concat(e),icon:"error",confirmButtonText:"Cerrar"}),console.log("Error: ",a)}}}(),className:"w-100 btn btn-lg btn-primary",type:"button",children:"Firmar"}),Object(l.jsx)("hr",{className:"my-4"})]}),Object(l.jsx)("div",{})]})]})})]}),Object(l.jsx)("div",{className:v?"d-none":"",children:Object(l.jsx)(p,{})}),Object(l.jsx)("div",{className:"modal fade",id:"contratoModal","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"contratoModalLabel","aria-hidden":"true",children:Object(l.jsx)("div",{className:"modal-dialog",children:Object(l.jsxs)("div",{className:"modal-content",children:[Object(l.jsxs)("div",{className:"modal-header",children:[Object(l.jsx)("h5",{className:"modal-title",id:"contratoModalLabel",children:"Contrato de pago en Hash"}),Object(l.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(l.jsxs)("div",{className:"modal-body",children:["Existe un ataque que puede producirse de la forma siguiente:",Object(l.jsx)("br",{}),Object(l.jsx)("br",{}),"Usted realiza algunos pagos con un contrato y luego decide destruirlo. M\xe1s tarde, implementa un nuevo contrato inteligente, con el mismo c\xf3digo, para realizar otros pagos. \xc9ste nuevo contrato desconoce las series de los cheques que se han pagado en la implementaci\xf3n anterior, por lo que el usuario puede volver a usar los mismos datos con el hash firmado para realizar un doble cobro. Nos podemos proteger contra esto al incluir la direcci\xf3n del contrato en el mensaje, y por tanto, solo se aceptar\xe1n los cheques firmados que correspondan con el contrato implementado para ellos."]}),Object(l.jsx)("div",{className:"modal-footer",children:Object(l.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})}),Object(l.jsx)("div",{className:"modal fade",id:"serieModal","data-bs-backdrop":"static","data-bs-keyboard":"false","aria-labelledby":"serieModalLabel","aria-hidden":"true",children:Object(l.jsx)("div",{className:"modal-dialog",children:Object(l.jsxs)("div",{className:"modal-content",children:[Object(l.jsxs)("div",{className:"modal-header",children:[Object(l.jsx)("h5",{className:"modal-title",id:"serieModalLabel",children:"Serie de los cheques"}),Object(l.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),Object(l.jsxs)("div",{className:"modal-body",children:["Nosotros creamos un n\xfamero de serie \xfanico con un ",Object(l.jsx)("i",{children:"stamp time"})," cuando cargamos la p\xe1gina. Pero usted puede crear todos los cheques que desee con cualquier otra numeraci\xf3n. Sin embargo, tenga en cuenta que si usted firma un cheque con un n\xfamero de serie que ya se ha utilizado para abonar otro cheque por parte de otro usuario ",Object(l.jsx)("strong",{children:"el suyo no podr\xe1 ser abonado"}),".",Object(l.jsx)("br",{}),Object(l.jsx)("br",{}),"Puede comprobar si un n\xfamero de serie se ha utilizado desde las funciones ",Object(l.jsx)("i",{children:"getters"})," que tenemos en el contrato. ",Object(l.jsx)("br",{}),Object(l.jsx)("br",{}),"Para saber si una serie ya se ha utilizado use la funci\xf3n: ",Object(l.jsx)("i",{children:"usedNonces"}),", para saber quien lo ha cobrado con la funci\xf3n: ",Object(l.jsx)("i",{children:"noncesRecipients"}),", y la cantidad que se ha abonado con la funci\xf3n: ",Object(l.jsx)("i",{children:"noncesAmount"}),". Aqu\xed dispone del enlace para que haga esas comprobaciones si es su deseo:",Object(l.jsx)("br",{}),Object(l.jsx)("br",{}),Object(l.jsx)("a",{href:"https://testnet.bscscan.com/address/0x00e55244c13FfA6D6313718459D82536F43F6dcf#readContract",target:"_blank",rel:"noreferrer",children:Object(l.jsx)("i",{children:"Read Functions"})})]}),Object(l.jsx)("div",{className:"modal-footer",children:Object(l.jsx)("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Close"})})]})})}),Object(l.jsxs)("footer",{className:"text-center text-white my-3 container",style:{backgroundColor:"#0a4275"},children:[Object(l.jsx)("div",{className:"p-4 pb-0",children:Object(l.jsx)("section",{className:"",children:Object(l.jsxs)("a",{className:"text-decoration-none",href:"https://github.com/Cainuriel/ERC-Contracts/tree/main/payment-channel",target:"_blank",rel:"noreferrer",children:[" ",Object(l.jsxs)("p",{className:"d-flex justify-content-center align-items-center",children:[Object(l.jsx)("span",{className:"me-3",children:"C\xf3digo en Github "}),Object(l.jsx)("i",{className:"fab fa-github"})]})]})})}),Object(l.jsxs)("div",{className:"text-center p-3 container",style:{backgroundColor:"rgba(0, 0, 0, 0.2)"},children:["2021 ",Object(l.jsxs)("a",{className:"text-white text-decoration-none",href:"https://cainuriel.github.io/",children:[" ",Object(l.jsx)("img",{src:"./favicon.ico"}),"Developer Superloper"]})]})]})]})};var g=e=>{e&&e instanceof Function&&t.e(3).then(t.bind(null,56)).then((a=>{let{getCLS:t,getFID:n,getFCP:s,getLCP:c,getTTFB:r}=a;t(e),n(e),s(e),c(e),r(e)}))};r.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(x,{})}),document.getElementById("root")),g()}},[[54,1,2]]]);
//# sourceMappingURL=main.3dfbb973.chunk.js.map